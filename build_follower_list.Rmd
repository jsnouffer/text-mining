---
jupyter:
  jupytext:
    text_representation:
      extension: .Rmd
      format_name: rmarkdown
      format_version: '1.1'
      jupytext_version: 1.2.3
  kernelspec:
    display_name: Python 3
    language: python
    name: python3
---

```{python}
from elasticsearch import Elasticsearch

from elasticsearch import helpers
scan = helpers.scan

es = Elasticsearch([{'host':'localhost','port':9200}])
es

indx = 'redditors.followers'

try:
    es.indices.create(index = indx)
except:
    pass
```

```{python}
results = scan(es,         
    query = {
        "query": {
            "bool": {
                "must": [
                    {
                        "exists": {
                            "field": "commenters"
                        }
                    }
                ]
            }
        }
    }, index = 'redditors')

for result in results:
    commenters = result['_source']['commenters']
    for commenter in commenters:
        doc = {}
        doc['name'] = commenter
        es.index(index = indx, id = commenter, body = doc)
```
